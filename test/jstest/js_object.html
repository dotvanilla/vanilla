<script src="linq.min.js"></script>
<script src="visualbasic.wasm.js"></script>

<script>
// WebAssembly Demo
    vanilla.Wasm.showDebugMessage(false);
    vanilla.Wasm.RunAssembly("../vbscripts/js_object.wasm", {
      run: app => {
        console.log(app);
		
		var intptr = app.objectGC.getObject()		
		
		// WebAssembly.GarbageCollection.addObject(intptr, 350);
		// WebAssembly.GarbageCollection.addObject(1077, 13);
		var array = app.numberArray.createVector();
		var strings = app.numberArray.namesVector();
		var structs = app.numberArray.structures();
		
      console.log(array);
console.log(WebAssembly.ObjectManager.readArray(array));
	  console.log(WebAssembly.ObjectManager.getObject(strings));
	  console.log(WebAssembly.ObjectManager.getObject(structs));
	  
		console.log(intptr);
		console.log(WebAssembly.GarbageCollection.getType(intptr));
		console.log(WebAssembly.ObjectManager.getObject(intptr))
		
console.log(WebAssembly.ObjectManager.getObject(app.objectGC.newCircle()));
console.log(WebAssembly.ObjectManager.getObject(app.objectGC.newCircle()));
      },
      api: { console: true, text: true, array: true }
    });

</script>