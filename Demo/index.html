<div>
	<blockquote id="text"></blockquote>
</div>

<hr />

<div id="notes">

</div>

<div>
<p><span id="result"></span></p>
</div>

<div id="base64-display"></div>
<div id="base64-display2" style="color: blue; background-color: lightgreen;"></div>

<script type="text/javascript" src="javascript/visualbasic.wasm.js"></script>
<script type="text/javascript">
	TypeScript.Wasm.RunAssembly("vbscript/HelloWorld.wasm", {
		run: doc => {
			doc.RunApp();
			doc.DisplayResult(15, 10.99, "3em", "yellow");
			
			var jsVerify = js_PoissonPDF(15, 10.99);
			var wasm_result = doc.PoissonPDF(15, 10.99)
			
			console.log(jsVerify);
			console.log(wasm_result);
			
			TypeScript.Wasm.RunAssembly("vbscript/base64.wasm", {
				run : encoder => {
					var base64 = encoder.encode("Hi, Hello world!");
					
					document.getElementById("base64-display").innerText = base64;
					
					var raw = encoder.decode(base64);
					
					console.log("The raw text of this base64 input is:");
					console.warn(raw);
					
					console.log("decode base64 string from server response:");
										
					var server = GET("base64.php");
					
					console.log("base64: " + server)
					
					raw = encoder.decode(server);
					
					console.log("The raw text of this base64 input is:");
					console.warn(raw);
					
					document.getElementById("base64-display2").innerText = raw;
					
					// WebAssembly.ObjectManager.printTextCache();
				},
				api: {console: true, text: true, array: true}
			});
		},
		api: { document: true, console: true }
	});	
	
	function GET(url) {
        var request = new XMLHttpRequest();

        // `false` makes the request synchronous
        request.open('GET', url, false);
        request.send(null);

        if (request.status === 200) {
            return request.responseText;
        } else {
            return null;
        }
    }
	
	 function js_PoissonPDF(k, lambda) {
        var result = Math.exp(-lambda)

        while (k >= 1){
            result *= lambda / k
            k -= 1
        }

        return result
    }
</script>